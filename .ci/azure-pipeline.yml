# THIS FILE IS AUTOGENERATED -- DO NOT EDIT #
#   Edit and Re-run template.ci.py instead       #

#************ definition of base jobs *********************************************************************************#







stages:

  - stage: s_0
    displayName: 0
    jobs:

    - job: python_builder_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make python_builder_3.6
            make push_python_builder_3.6

    - job: python_builder_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make python_builder_3.7
            make push_python_builder_3.7

    - job: python_builder_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make python_builder_3.8
            make push_python_builder_3.8


    - job: deploy_checks
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
            docker version
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make deploy_checks
            make push_deploy_checks


  - stage: s_1
    displayName: 1
    jobs:

    - job: ci_sanity
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
            docker version
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make ci_sanity
            make push_ci_sanity

    - job: python_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make python_3.6
            make push_python_3.6

    - job: python_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make python_3.7
            make push_python_3.7

    - job: python_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make python_3.8
            make push_python_3.8



  - stage: s_2
    displayName: 2
    jobs:

    - job: constraints_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make constraints_3.6
            make push_constraints_3.6

    - job: constraints_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make constraints_3.7
            make push_constraints_3.7

    - job: constraints_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make constraints_3.8
            make push_constraints_3.8


    - job: dealii_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make dealii_3.6
            make push_dealii_3.6

    - job: dealii_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make dealii_3.7
            make push_dealii_3.7

    - job: dealii_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make dealii_3.8
            make push_dealii_3.8


    - job: petsc_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make petsc_3.6
            make push_petsc_3.6

    - job: petsc_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make petsc_3.7
            make push_petsc_3.7

    - job: petsc_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make petsc_3.8
            make push_petsc_3.8



  - stage: s_3
    displayName: 3
    jobs:

    - job: pypi__mirror_stable_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make pypi-mirror_stable_3.6
            make push_pypi-mirror_stable_3.6

    - job: pypi__mirror_stable_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make pypi-mirror_stable_3.7
            make push_pypi-mirror_stable_3.7

    - job: pypi__mirror_stable_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make pypi-mirror_stable_3.8
            make push_pypi-mirror_stable_3.8


    - job: pypi__mirror_oldest_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make pypi-mirror_oldest_3.6
            make push_pypi-mirror_oldest_3.6

    - job: pypi__mirror_oldest_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make pypi-mirror_oldest_3.7
            make push_pypi-mirror_oldest_3.7

    - job: pypi__mirror_oldest_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make pypi-mirror_oldest_3.8
            make push_pypi-mirror_oldest_3.8


    - job: ngsolve_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make ngsolve_3.6
            make push_ngsolve_3.6

    - job: ngsolve_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make ngsolve_3.7
            make push_ngsolve_3.7

    - job: ngsolve_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make ngsolve_3.8
            make push_ngsolve_3.8


    - job: fenics_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make fenics_3.6
            make push_fenics_3.6

    - job: fenics_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make fenics_3.7
            make push_fenics_3.7

    - job: fenics_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make fenics_3.8
            make push_fenics_3.8



  - stage: s_4
    displayName: 4
    jobs:
    - job: wheelbuilder_manylinux1_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux1_3.6
            make push_wheelbuilder_manylinux1_3.6

    - job: wheelbuilder_manylinux1_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux1_3.7
            make push_wheelbuilder_manylinux1_3.7

    - job: wheelbuilder_manylinux1_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux1_3.8
            make push_wheelbuilder_manylinux1_3.8


    - job: wheelbuilder_manylinux2010_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux2010_3.6
            make push_wheelbuilder_manylinux2010_3.6

    - job: wheelbuilder_manylinux2010_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux2010_3.7
            make push_wheelbuilder_manylinux2010_3.7

    - job: wheelbuilder_manylinux2010_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux2010_3.8
            make push_wheelbuilder_manylinux2010_3.8


    - job: wheelbuilder_manylinux2014_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux2014_3.6
            make push_wheelbuilder_manylinux2014_3.6

    - job: wheelbuilder_manylinux2014_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux2014_3.7
            make push_wheelbuilder_manylinux2014_3.7

    - job: wheelbuilder_manylinux2014_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make wheelbuilder_manylinux2014_3.8
            make push_wheelbuilder_manylinux2014_3.8



    - job: cibase_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make cibase_3.6
            make push_cibase_3.6

    - job: cibase_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make cibase_3.7
            make push_cibase_3.7

    - job: cibase_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make cibase_3.8
            make push_cibase_3.8



  - stage: s_5
    displayName: 5
    jobs:

    - job: testing_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make testing_3.6
            make push_testing_3.6

    - job: testing_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make testing_3.7
            make push_testing_3.7

    - job: testing_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make testing_3.8
            make push_testing_3.8


    - job: demo_master
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
            docker version
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make demo_master
            make push_demo_master


  - stage: s_6
    displayName: 6
    jobs:

    - job: jupyter_3_6
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make jupyter_3.6
            make push_jupyter_3.6

    - job: jupyter_3_7
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make jupyter_3.7
            make push_jupyter_3.7

    - job: jupyter_3_8
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker version
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make jupyter_3.8
            make push_jupyter_3.8


    - job: docker__in__docker
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
            docker version
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make docker-in-docker
            make push_docker-in-docker

    - job: docs
      timeoutInMinutes: 0
      pool:
        vmImage: 'ubuntu-16.04'
      variables:
        DOCKER_CLI_EXPERIMENTAL: enabled
        DOCKER_BUILDKIT: 1
      steps:
        - checkout: self
          submodules: true
        - script: |
            echo '{"experimental": true}' | sudo tee /etc/docker/daemon.json
            sudo systemctl restart docker
            docker system prune -af
            sudo rm -rf /opt/{google,cabal,microsoft,mssql-tools,ghc,hhvm,AGPM,hostedtoolcache} /usr/man /usr/local/man /usr/local/julia*
            docker version
          displayName: "setup docker & remove unused packages"
        - task: Docker@2
          displayName: Container registry login
          inputs:
            command: login
            containerRegistry: dockerhub
        - script: |
            make docs
            make push_docs

# THIS FILE IS AUTOGENERATED -- DO NOT EDIT #
#   Edit and Re-run template.ci.py instead       #
